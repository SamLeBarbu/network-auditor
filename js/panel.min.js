function parseFilters(e){const t=e.split(/\s+/).map(e=>e.trim());return t}function applyNetworkFilters(e){chrome.devtools.network.onRequestFinished.addListener(t=>{const n=t.request.url;let l=e.some(e=>n.includes(e));l&&addRequestToTable(t)})}function updateRequestList(){const e=filterInput.value.toLowerCase(),t=filterTypeSelect.value,n=parseFilters(e);requestList.innerHTML="",pageUrls.forEach(e=>{addPageUrlRow(e.url);const l=networkRequests.filter(e=>{const l=e.request.url.toLowerCase();return"and"===t?n.every(e=>l.includes(e)):n.some(e=>l.includes(e))});l.forEach(e=>{addRequestToTable(e)})})}function addRequestToTable(e){let t;e.request.url.includes("?")?(t=e.request.url.split("?")[0].split("/").slice(-1),t+="?"+e.request.url.split("?")[1]):t=e.request.url.split("/").slice(-1),e.request.url.includes("gtm.js")?favicon="gtm":e.request.url.includes("cdn.tagcommander.com")||e.request.url.includes("cdn.trustcommander.net")?favicon="commandersact":e.request.url.includes("xiti.com/event")?favicon="piano":e.request.url.includes("xiti.com/hit.xiti")?favicon="atinternet":e.request.url.includes("contentsquare.net/uxa")||e.request.url.includes("contentsquare.net/v2")||e.request.url.includes("contentsquare.net/pageview")?favicon="contentsquare":e.request.url.includes("n.clarity.ms/collect")?favicon="clarity":e.request.url.includes("data.kameleoon.eu")?favicon="kameleoon":e.request.url.includes("try.abtasty.com")||e.request.url.includes("ariane.abtasty.com")?favicon="abtasty":(e.request.url.includes("bat.bing.com/action")||e.request.url.includes("bat.bing.com/p/action")||e.request.url.includes("bat.bing.net/actionp"))&&(favicon="bing");const n=e.response.content.mimeType.split("/")[1],l=document.createElement("tr");favicon="gtm"==favicon||"commandersact"==favicon||"piano"==favicon||"atinternet"==favicon||"contentsquare"==favicon||"clarity"==favicon||"kameleoon"==favicon||"abtasty"==favicon||"bing"==favicon?`<img src="../favicons/favicon_${favicon}.png" alt="favicon" class="favicon">`:"",l.className="request-item",l.innerHTML=`\n        <td title="${e.request.url}">${favicon}/${t}</td>\n        <td>${e.response.status}</td>\n        <td>${e.request.method}</td>\n        <td>${n}</td>\n    `,l.addEventListener("click",()=>{isPreview=!(!(e.request.url.includes("cdn.tagcommander.com")||e.request.url.endsWith(".js")||e.request.url.includes(".json"))||e.request.url.includes("xiti.com")),showRequestDetails(e)}),requestList.appendChild(l)}function addPageUrlRow(e){const t=e.split("?")[0],n=document.createElement("tr");n.className="page-url-item",n.innerHTML=`\n        <td colspan="4" class="page-url">${t}</td>\n    `,requestList.appendChild(n)}function showRequestDetails(e){e.getContent(t=>{let n,l=e.request.url;if(console.log("isPreview",isPreview),l.includes("%")&&(l=decodeURIComponent(l)),!0===isPreview)e.request.url.includes(".json")&&(t=JSON.stringify(JSON.parse(t),null,2)),n=`\n        <span class="green">URL:</span><br><a href="${e.request.url}" target="_blank" class="code"><pre>${l}</pre></a><br><br>\n        <span class="green">Preview:</span><br><pre>${t}</pre><br><br>\n      `;else{let t=e.request.queryString.map(e=>`${e.name}: ${e.value}`).join("\n"),u=e.request.postData?JSON.stringify(JSON.parse(e.request.postData.text),null,2):"N/A";t.includes("%")&&(t=decodeURIComponent(t)),u.includes("%")&&(u=decodeURIComponent(u)),n=`\n        <span class="green">URL:</span><br><a href="${e.request.url}" target="_blank" class="code"><pre>${l}</pre></a><br><br>\n        <span class="green">Query Parameters:</span><br><pre>${t}</pre><br><br>\n        <span class="green">Request Payload:</span><br><pre>${u}</pre>\n        `}requestDetails.innerHTML=n,overlay.style.display="block"})}const filterInput=document.getElementById("filter-input"),filterTypeSelect=document.getElementById("filter-type"),requestList=document.getElementById("request-list"),showFilters=document.getElementById("showFilters"),clearFilters=document.getElementById("clearFilters"),clearRequestsButton=document.getElementById("clearRequests"),overlay=document.getElementById("overlay"),closeOverlayButton=document.getElementById("closeOverlay"),requestDetails=document.getElementById("requestDetails"),trustoCoButton=document.getElementById("trustoCoButton"),oneTrustButton=document.getElementById("oneTrustButton"),cookieBotButton=document.getElementById("cookieBotButton"),didomiButton=document.getElementById("didomiButton"),tarteAuCitronButton=document.getElementById("tarteAuCitronButton"),gtmButtonClientSide=document.getElementById("gtmButtonClientSide"),gtmButtonServerSide=document.getElementById("gtmButtonServerSide"),tagCoButton=document.getElementById("tagCoButton"),ga4ButtonClientSide=document.getElementById("ga4ButtonClientSide"),ga4ButtonServerSide=document.getElementById("ga4ButtonServerSide"),googleAdsButton=document.getElementById("googleAdsButton"),googleTagButton=document.getElementById("googleTagButton"),pianoButton=document.getElementById("pianoButton"),atinternetButton=document.getElementById("atinternetButton"),piwikButton=document.getElementById("piwikButton"),csButton=document.getElementById("csButton"),clarityButton=document.getElementById("clarityButton"),kameleoonButton=document.getElementById("kameleoonButton"),abtastyButton=document.getElementById("abtastyButton"),bingButton=document.getElementById("bingButton");let favicon,networkRequests=[],pageUrls=[],isPreview=!1;chrome.devtools.network.onRequestFinished.addListener(e=>{networkRequests.push(e),updateRequestList()}),chrome.devtools.network.onNavigated.addListener(e=>{pageUrls.push({url:e,requests:[]}),updateRequestList()}),filterInput.addEventListener("input",updateRequestList),filterTypeSelect.addEventListener("change",updateRequestList),showFilters.addEventListener("click",()=>{"block"===document.getElementById("divFilters").style.display?(document.getElementById("divFilters").style.display="none",showFilters.style.backgroundColor="#36eba9",showFilters.style.color="#280137",showFilters.innerText="Show predefined filters"):(document.getElementById("divFilters").style.display="block",showFilters.style.backgroundColor="#eb3678",showFilters.style.color="white",showFilters.innerText="Hide predefined filters",overlay.style.display="none")}),clearFilters.addEventListener("click",()=>{document.getElementById("filter-input").value="",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),clearRequestsButton.addEventListener("click",()=>{networkRequests=[],pageUrls=[],updateRequestList()}),closeOverlayButton.addEventListener("click",()=>{overlay.style.display="none"}),tagCoButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="cdn.tagcommander.com",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),trustCoButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="cdn.trustcommander.net/privacy",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),oneTrustButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="cdn.cookielaw.org/scripttemplates",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),pianoButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="xiti.com/event",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),atinternetButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="xiti.com/hit.xiti",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),csButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="contentsquare.net/uxa contentsquare.net/pageview contentsquare.net/v2",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),clarityButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="n.clarity.ms/collect",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),kameleoonButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="data.kameleoon.eu",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),abtastyButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="try.abtasty.com ariane.abtasty.com",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),bingButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="bat.bing.com/action bat.bing.com/p/action bat.bing.net/actionp",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),gtmButtonClientSide.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="www.googletagmanager.com",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),gtmButtonServerSide.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="gtm.js",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),ga4ButtonClientSide.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="google-analytics.com/collect",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),ga4ButtonServerSide.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="/g/collect",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),googleTagButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="google.com/ccm/collect",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),googleAdsButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="googletagmanager.com/gtag/js?id=AW- g.doubleclick.net/",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),piwikButton.addEventListener("click",()=>{""!==filterInput.value.trim()&&(filterInput.value+=" "),filterInput.value+="ppms.php",updateRequestList(),chrome.storage.sync.set({filterValue:filterInput.value})}),chrome.storage.sync.get("filterValue",({filterValue:e})=>{e&&(filterInput.value=e,updateRequestList())}),filterInput.addEventListener("input",()=>{chrome.storage.sync.set({filterValue:filterInput.value})}),tagCoButton.addEventListener("click",()=>{chrome.storage.sync.set({filterValue:filterInput.value})});