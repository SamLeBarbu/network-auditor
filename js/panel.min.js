function activateButton(t,e){""!==filterHidden.value.trim()&&(filterHidden.value+=" OR ",activatedButtons.value+="|"),filterHidden.value+=e,activatedButtons.value+=t,updateRequestList(),chrome.storage.sync.set({filterHiddenValue:filterHidden.value}),chrome.storage.sync.set({activatedButtonsValue:activatedButtons.value}),document.getElementById(t)&&(document.getElementById(t).className="normalButtonGreen"),document.getElementById("tiny_"+t).style.display="inline"}function deactivateButton(t,e){filterHidden.value=filterHidden.value.replace(e,""),filterHidden.value=filterHidden.value.replace(" OR  OR "," OR "),filterHidden.value.endsWith(" OR ")&&(filterHidden.value=filterHidden.value.slice(0,-4)),filterHidden.value.startsWith(" OR ")&&(filterHidden.value=filterHidden.value.slice(4)),activatedButtons.value=activatedButtons.value.replace(t,""),activatedButtons.value=activatedButtons.value.replace("||","|"),activatedButtons.value.endsWith("|")&&(activatedButtons.value=activatedButtons.value.slice(0,-1)),activatedButtons.value.startsWith("|")&&(activatedButtons.value=activatedButtons.value.slice(1)),updateRequestList(),chrome.storage.sync.set({filterHiddenValue:filterHidden.value}),chrome.storage.sync.set({activatedButtonsValue:activatedButtons.value}),document.getElementById(t)&&(document.getElementById(t).className="normalButton"),document.getElementById("tiny_"+t).style.display="none"}function applyNetworkFilters(t){chrome.devtools.network.onRequestFinished.addListener(e=>{const s=e.request.url;let n=t.some(t=>s.includes(t));n&&addRequestToTable(e)})}function updateRequestList(){const t=filterInput.value.toLowerCase(),e=filterHidden.value.toLowerCase();let s;s=""!==t.trim()&&""!==e.trim()?t+" OR "+e:""!==t.trim()&&""===e.trim()?t:""===t.trim()&&""!==e.trim()?e:"",requestList.innerHTML="",pageUrls.forEach(t=>{addPageUrlRow(t.url);networkRequests.filter(t=>{const e=t.request.url.toLowerCase(),n=parseQuery(s);""!==s?evaluate(n,e)&&addRequestToTable(t):addRequestToTable(t)})})}function addRequestToTable(t){let e;t.request.url.includes("?")?(e=t.request.url.split("?")[0].split("/").slice(-1),e+="?"+t.request.url.split("?")[1]):e=t.request.url.split("/").slice(-1),t.request.url.includes("gtm.js")?toolFavicon="gtm":t.request.url.includes("cdn.tagcommander.com")||t.request.url.includes("cdn.trustcommander.net")?toolFavicon="commandersact":t.request.url.includes("xiti.com/event")?toolFavicon="piano":t.request.url.includes("xiti.com/hit.xiti")?toolFavicon="atinternet":t.request.url.includes("contentsquare.net/uxa")||t.request.url.includes("contentsquare.net/v2")||t.request.url.includes("contentsquare.net/pageview")?toolFavicon="contentsquare":t.request.url.includes("n.clarity.ms/collect")?toolFavicon="clarity":t.request.url.includes("data.kameleoon.eu")?toolFavicon="kameleoon":t.request.url.includes("try.abtasty.com")||t.request.url.includes("ariane.abtasty.com")?toolFavicon="abtasty":t.request.url.includes("bat.bing.com/action")||t.request.url.includes("bat.bing.com/p/action")||t.request.url.includes("bat.bing.net/actionp")?toolFavicon="bing":t.request.url.includes("/g/collect")||t.request.url.includes("googletagmanager.com/gtag/js?id=G-")?toolFavicon="ga4":t.request.url.includes("google.com/ccm/collect")?toolFavicon="google":(t.request.url.includes("doubleclick.net")||t.request.url.includes("googletagmanager.com/gtag/js?id=AW-")||t.request.url.includes("googletagmanager.com/gtag/js?id=DC-"))&&(toolFavicon="googleads");const s=t.response.content.mimeType.split("/")[1],n=document.createElement("tr");"gtm"==toolFavicon||"commandersact"==toolFavicon||"piano"==toolFavicon||"atinternet"==toolFavicon||"contentsquare"==toolFavicon||"clarity"==toolFavicon||"kameleoon"==toolFavicon||"abtasty"==toolFavicon||"bing"==toolFavicon||"ga4"==toolFavicon||"google"==toolFavicon||"googleads"==toolFavicon?(toolFavicon=`<img src="../favicons/favicon_${toolFavicon}.png" alt="favicon" class="favicon">`,t.request.url.includes(".js")||t.request.url.includes("/js")?toolFavicon+=' <img src="../favicons/js_green.png" alt="js" class="favicon"> ':toolFavicon+=' <img src="../favicons/send_pink.png" alt="js" class="favicon"> '):toolFavicon="",n.className="request-item",n.innerHTML=`\n        <td title="${t.request.url}">${toolFavicon}/${e}</td>\n        <td>${t.response.status}</td>\n        <td>${t.request.method}</td>\n        <td>${s}</td>\n    `,n.addEventListener("click",()=>{isPreview=!(!(t.request.url.includes("cdn.tagcommander.com")||t.request.url.endsWith(".js")||t.request.url.includes(".json"))||t.request.url.includes("xiti.com")),showRequestDetails(t)}),requestList.appendChild(n)}function addPageUrlRow(t){const e=t.split("?")[0],s=document.createElement("tr");s.className="page-url-item",s.innerHTML=`\n        <td colspan="4" class="page-url">${e}</td>\n    `,requestList.appendChild(s)}function showRequestDetails(t){t.getContent(e=>{let s,n=t.request.url;if(n.includes("%")&&(n=decodeURIComponent(n)),!0===isPreview)t.request.url.includes(".json")&&(e=JSON.stringify(JSON.parse(e),null,2)),s=`\n        <span class="green">URL:</span><br><a href="${t.request.url}" target="_blank" class="code"><pre>${n}</pre></a><br><br>\n        <span class="green">Preview:</span><br><pre>${e}</pre><br><br>\n      `;else{let e=t.request.queryString.map(t=>`${t.name}: ${t.value}`).join("\n"),o=t.request.postData?JSON.stringify(JSON.parse(t.request.postData.text),null,2):"N/A";e.includes("%")&&(e=decodeURIComponent(e)),o.includes("%")&&(o=decodeURIComponent(o)),s=`\n        <span class="green">URL:</span><br><a href="${t.request.url}" target="_blank" class="code"><pre>${n}</pre></a><br><br>\n        <span class="green">Query Parameters:</span><br><pre>${e}</pre><br><br>\n        <span class="green">Request Payload:</span><br><pre>${o}</pre>\n        `}requestDetails.innerHTML=s,overlay.style.display="block"})}function tokenize(t){t=t.replace(/\(/g," ( ").replace(/\)/g," ) ").toLowerCase();const e=t.trim().split(/\s+/);return e.filter(Boolean)}function parseQuery(t){const e=new TokenStream(tokenize(t)),s=parseOrExpr(e);if(e.hasMore())throw new Error("Unexpected extra tokens after parsing.");return s}function parseOrExpr(t){let e=parseAndExpr(t);for(;"or"===t.peek();){t.next();const s=parseAndExpr(t);e={type:"binary",op:"OR",left:e,right:s}}return e}function parseAndExpr(t){let e=parseFactor(t);for(;"and"===t.peek();){t.next();const s=parseFactor(t);e={type:"binary",op:"AND",left:e,right:s}}return e}function parseFactor(t){if("not"===t.peek()){t.next();const e=parseFactor(t);return{type:"unary",op:"NOT",node:e}}if("("===t.peek()){t.next();const e=parseOrExpr(t);if(")"!==t.peek())throw new Error("Missing closing parenthesis.");return t.next(),e}const e=t.next();return{type:"literal",value:e}}function evaluate(t,e){switch(t.type){case"literal":return e.includes(t.value);case"unary":return!evaluate(t.node,e);case"binary":const s=evaluate(t.left,e),n=evaluate(t.right,e);if("AND"===t.op)return s&&n;if("OR"===t.op)return s||n;throw new Error("Unknown binary operator: "+t.op);default:throw new Error("Unknown AST node type: "+t.type)}}function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?backToTop.style.display="block":backToTop.style.display="none"}const filterInput=document.getElementById("filterInput"),filterHidden=document.getElementById("filterHidden"),activatedButtons=document.getElementById("activatedButtons"),requestList=document.getElementById("requestList"),showPredifinedFilters=document.getElementById("showPredifinedFilters"),showCustomFilters=document.getElementById("showCustomFilters"),divPredefinedFilters=document.getElementById("divPredefinedFilters"),divCustomFilters=document.getElementById("divCustomFilters"),clearFilters=document.getElementById("clearFilters"),clearRequestsButton=document.getElementById("clearRequests"),overlay=document.getElementById("overlay"),closeOverlayButton=document.getElementById("closeOverlay"),requestDetails=document.getElementById("requestDetails"),trustCoButton=document.getElementById("trustCoButton"),oneTrustButton=document.getElementById("oneTrustButton"),cookieBotButton=document.getElementById("cookieBotButton"),didomiButton=document.getElementById("didomiButton"),tarteAuCitronButton=document.getElementById("tarteAuCitronButton"),gtmClientSideButton=document.getElementById("gtmClientSideButton"),gtmServerSideButton=document.getElementById("gtmServerSideButton"),tagCoButton=document.getElementById("tagCoButton"),ga4ClientSideButton=document.getElementById("ga4ClientSideButton"),ga4ServerSideButton=document.getElementById("ga4ServerSideButton"),googleAdsButton=document.getElementById("googleAdsButton"),googleTagButton=document.getElementById("googleTagButton"),pianoButton=document.getElementById("pianoButton"),atinternetButton=document.getElementById("atinternetButton"),piwikButton=document.getElementById("piwikButton"),csButton=document.getElementById("csButton"),clarityButton=document.getElementById("clarityButton"),kameleoonButton=document.getElementById("kameleoonButton"),abtastyButton=document.getElementById("abtastyButton"),bingButton=document.getElementById("bingButton"),popinNews=document.getElementById("popinNews"),closePopinNews=document.getElementById("closePopinNews"),menuNews=document.getElementById("menuNews"),popinBugs=document.getElementById("popinBugs"),closePopinBugs=document.getElementById("closePopinBugs"),menuBugs=document.getElementById("menuBugs"),menuHelp=document.getElementById("menuHelp"),closePopinHelp=document.getElementById("closePopinHelp"),popinHelp=document.getElementById("popinHelp"),backToTop=document.getElementById("backToTop"),customFilterswitch1=document.getElementById("customFilterswitch1"),customFilterswitch2=document.getElementById("customFilterswitch2"),customFilterswitch3=document.getElementById("customFilterswitch3"),customFilterswitch4=document.getElementById("customFilterswitch4"),customFilterswitch5=document.getElementById("customFilterswitch5"),customFilterswitch6=document.getElementById("customFilterswitch6"),customFilterInput1=document.getElementById("customFilterInput1"),customFilterInput2=document.getElementById("customFilterInput2"),customFilterInput3=document.getElementById("customFilterInput3"),customFilterInput4=document.getElementById("customFilterInput4"),customFilterInput5=document.getElementById("customFilterInput5"),customFilterInput6=document.getElementById("customFilterInput6");let toolFavicon,requestType,networkRequests=[],pageUrls=[],isPreview=!1;chrome.devtools.network.onRequestFinished.addListener(t=>{networkRequests.push(t),updateRequestList()}),chrome.devtools.network.onNavigated.addListener(t=>{pageUrls.push({url:t,requests:[]}),updateRequestList()}),filterInput.addEventListener("input",updateRequestList),filterHidden.addEventListener("input",updateRequestList),showPredifinedFilters.addEventListener("click",()=>{"show"===divPredefinedFilters.attributes["data-status"].value?(divPredefinedFilters.className="divPredefinedFiltersOut",showPredifinedFilters.style.backgroundColor="#36eba9",showPredifinedFilters.style.color="#280137",showPredifinedFilters.innerText="Show predefined filters",divPredefinedFilters.attributes["data-status"].value="hidden",_paq.push(["trackEvent","Actions","Hide predifined filters"]),setTimeout(()=>{divPredefinedFilters.style.display="none"},400)):(divPredefinedFilters.className="divPredefinedFiltersIn",divPredefinedFilters.style.display="block",showPredifinedFilters.style.backgroundColor="#eb3678",showPredifinedFilters.style.color="white",showPredifinedFilters.innerText="Hide predefined filters",overlay.style.display="none",divPredefinedFilters.attributes["data-status"].value="show",_paq.push(["trackEvent","Actions","Show predifined filters"]))}),showCustomFilters.addEventListener("click",()=>{"show"===divCustomFilters.attributes["data-status"].value?(divCustomFilters.className="divCustomFiltersOut",showCustomFilters.style.backgroundColor="#36eba9",showCustomFilters.style.color="#280137",showCustomFilters.innerText="Show custom filters",divCustomFilters.attributes["data-status"].value="hidden",_paq.push(["trackEvent","Actions","Hide custom filters"]),setTimeout(()=>{divCustomFilters.style.display="none"},400)):(divCustomFilters.className="divCustomFiltersIn",divCustomFilters.style.display="block",showCustomFilters.style.backgroundColor="#eb3678",showCustomFilters.style.color="white",showCustomFilters.innerText="Hide custom filters",overlay.style.display="none",divCustomFilters.attributes["data-status"].value="show",_paq.push(["trackEvent","Actions","Show custom filters"]))}),clearFilters.addEventListener("click",()=>{chrome.storage.sync.get("activatedButtonsValue",({activatedButtonsValue:t})=>{const e=t.split("|");e.forEach(t=>{document.getElementById(t).className="normalButton",document.getElementById("tiny_"+t).style.display="none"})});document.getElementById("filterInput").value="",document.getElementById("filterHidden").value="",document.getElementById("activatedButtons").value="",chrome.storage.sync.set({filterInputValue:""}),chrome.storage.sync.set({filterHiddenValue:""}),chrome.storage.sync.set({activatedButtonsValue:""}),updateRequestList(),_paq.push(["trackEvent","Actions","Clear filters"])}),clearRequestsButton.addEventListener("click",()=>{networkRequests=[],pageUrls=[],updateRequestList(),_paq.push(["trackEvent","Actions","Clear requests"])}),closeOverlayButton.addEventListener("click",()=>{overlay.style.display="none"});const buttons=Array.from(document.getElementsByClassName("normalButton")).map(t=>t.id);buttons.forEach(t=>{const e=document.getElementById(t);e.addEventListener("click",()=>{"normalButton"===e.className?(activateButton(t,e.attributes["data-syntax"].value),_paq.push(["trackEvent","Filters",t,"ON"])):(deactivateButton(t,e.attributes["data-syntax"].value),_paq.push(["trackEvent","Filters",t,"OFF"]))})}),chrome.storage.sync.get("filterInputValue",({filterInputValue:t})=>{t&&(filterInput.value=t,updateRequestList())}),chrome.storage.sync.get("filterHiddenValue",({filterHiddenValue:t})=>{t&&(filterHidden.value=t,updateRequestList())}),chrome.storage.sync.get("customFilterInput1Value",({customFilterInput1Value:t})=>{t&&(customFilterInput1.value=t)}),chrome.storage.sync.get("customFilterInput2Value",({customFilterInput2Value:t})=>{t&&(customFilterInput2.value=t)}),chrome.storage.sync.get("customFilterInput3Value",({customFilterInput3Value:t})=>{t&&(customFilterInput3.value=t)}),chrome.storage.sync.get("customFilterInput4Value",({customFilterInput4Value:t})=>{t&&(customFilterInput4.value=t)}),chrome.storage.sync.get("customFilterInput5Value",({customFilterInput5Value:t})=>{t&&(customFilterInput5.value=t)}),chrome.storage.sync.get("customFilterInput6Value",({customFilterInput6Value:t})=>{t&&(customFilterInput6.value=t)}),chrome.storage.sync.get("activatedButtonsValue",({activatedButtonsValue:t})=>{if(t){activatedButtons.value=t;const e=t.split("|");e.forEach(t=>{document.getElementById(t)&&(document.getElementById(t).className="normalButtonGreen"),document.getElementById("tiny_"+t).style.display="inline","customFilter1"===t?(customFilterswitch1.checked=!0,customFilterInput1.disabled=!0,chrome.storage.sync.get("customFilterInput1Value",({customFilterInput1Value:t})=>{customFilterInput1.value=t})):"customFilter2"===t?(customFilterswitch2.checked=!0,customFilterInput2.disabled=!0,chrome.storage.sync.get("customFilterInput2Value",({customFilterInput2Value:t})=>{customFilterInput2.value=t})):"customFilter3"===t?(customFilterswitch3.checked=!0,customFilterInput3.disabled=!0,chrome.storage.sync.get("customFilterInput3Value",({customFilterInput3Value:t})=>{customFilterInput3.value=t})):"customFilter4"===t?(customFilterswitch4.checked=!0,customFilterInput4.disabled=!0,chrome.storage.sync.get("customFilterInput4Value",({customFilterInput4Value:t})=>{customFilterInput4.value=t})):"customFilter5"===t?(customFilterswitch5.checked=!0,customFilterInput5.disabled=!0,chrome.storage.sync.get("customFilterInput5Value",({customFilterInput5Value:t})=>{customFilterInput5.value=t})):"customFilter6"===t&&(customFilterswitch6.checked=!0,customFilterInput6.disabled=!0,chrome.storage.sync.get("customFilterInput6Value",({customFilterInput6Value:t})=>{customFilterInput6.value=t}))})}}),filterInput.addEventListener("input",()=>{chrome.storage.sync.set({filterInputValue:filterInput.value})}),filterHidden.addEventListener("input",()=>{chrome.storage.sync.set({filterHiddenValue:filterHidden.value})}),activatedButtons.addEventListener("input",()=>{chrome.storage.sync.set({activatedButtonsValue:activatedButtons.value})});class TokenStream{constructor(t){this.tokens=t,this.index=0}peek(){return this.tokens[this.index]}next(){return this.tokens[this.index++]}hasMore(){return this.index<this.tokens.length}}menuNews.addEventListener("click",()=>{popinNews.style.display="block",_paq.push(["trackEvent","Menu","What's new"])}),menuBugs.addEventListener("click",()=>{popinBugs.style.display="block",_paq.push(["trackEvent","Menu","Bugs"])}),menuHelp.addEventListener("click",()=>{popinHelp.style.display="block",_paq.push(["trackEvent","Menu","Help"])}),closePopinNews.addEventListener("click",()=>{popinNews.style.display="none"}),closePopinBugs.addEventListener("click",()=>{popinBugs.style.display="none"}),closePopinHelp.addEventListener("click",()=>{popinHelp.style.display="none"}),backToTop.addEventListener("click",()=>{window.scrollTo(0,0),_paq.push(["trackEvent","Actions","Back to top"])}),window.onscroll=function(){scrollFunction()},customFilterswitch1.addEventListener("change",()=>{const t=customFilterswitch1.checked;if(chrome.storage.sync.set({customFilterswitch1Value:t}),!0===t){customFilterInput1.disabled=!0;const t=customFilterInput1.value;chrome.storage.sync.set({customFilterInput1Value:t}),activateButton("customFilter1",t),_paq.push(["trackEvent","Filters","Custom filter 1","ON"])}else{customFilterInput1.disabled=!1;const t=customFilterInput1.value;deactivateButton("customFilter1",t),_paq.push(["trackEvent","Filters","Custom filter 1","OFF"])}}),customFilterswitch2.addEventListener("change",()=>{const t=customFilterswitch2.checked;if(chrome.storage.sync.set({customFilterswitch2Value:t}),!0===t){customFilterInput2.disabled=!0;const t=customFilterInput2.value;chrome.storage.sync.set({customFilterInput2Value:t}),activateButton("customFilter2",t),_paq.push(["trackEvent","Filters","Custom filter 2","ON"])}else{customFilterInput2.disabled=!1;const t=customFilterInput2.value;deactivateButton("customFilter2",t),_paq.push(["trackEvent","Filters","Custom filter 2","OFF"])}}),customFilterswitch3.addEventListener("change",()=>{const t=customFilterswitch3.checked;if(chrome.storage.sync.set({customFilterswitch3Value:t}),!0===t){customFilterInput3.disabled=!0;const t=customFilterInput3.value;chrome.storage.sync.set({customFilterInput3Value:t}),activateButton("customFilter3",t),_paq.push(["trackEvent","Filters","Custom filter 3","ON"])}else{customFilterInput3.disabled=!1;const t=customFilterInput3.value;deactivateButton("customFilter3",t),_paq.push(["trackEvent","Filters","Custom filter 3","OFF"])}}),customFilterswitch4.addEventListener("change",()=>{const t=customFilterswitch4.checked;if(chrome.storage.sync.set({customFilterswitch4Value:t}),!0===t){customFilterInput4.disabled=!0;const t=customFilterInput4.value;chrome.storage.sync.set({customFilterInput4Value:t}),activateButton("customFilter4",t),_paq.push(["trackEvent","Filters","Custom filter 4","ON"])}else{customFilterInput4.disabled=!1;const t=customFilterInput4.value;deactivateButton("customFilter4",t),_paq.push(["trackEvent","Filters","Custom filter 4","OFF"])}}),customFilterswitch5.addEventListener("change",()=>{const t=customFilterswitch5.checked;if(chrome.storage.sync.set({customFilterswitch5Value:t}),!0===t){customFilterInput5.disabled=!0;const t=customFilterInput5.value;chrome.storage.sync.set({customFilterInput5Value:t}),activateButton("customFilter5",t),_paq.push(["trackEvent","Filters","Custom filter 5","ON"])}else{customFilterInput5.disabled=!1;const t=customFilterInput5.value;deactivateButton("customFilter5",t),_paq.push(["trackEvent","Filters","Custom filter 5","OFF"])}}),customFilterswitch6.addEventListener("change",()=>{const t=customFilterswitch6.checked;if(chrome.storage.sync.set({customFilterswitch6Value:t}),!0===t){customFilterInput6.disabled=!0;const t=customFilterInput6.value;chrome.storage.sync.set({customFilterInput6Value:t}),activateButton("customFilter6",t),_paq.push(["trackEvent","Filters","Custom filter 6","ON"])}else{customFilterInput6.disabled=!1;const t=customFilterInput6.value;deactivateButton("customFilter6",t),_paq.push(["trackEvent","Filters","Custom filter 6","OFF"])}});